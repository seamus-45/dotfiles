# Instruct tmux to treat top-bit-set characters in the status-left and status-right strings as UTF-8;
set-option -g status-utf8 on

# default statusbar colors
set-option -g status-style "bg=black,fg=yellow"

# default window title colors
set-window-option -g window-status-style "fg=yellow,bg=default"

# active window title colors
set-window-option -g window-status-current-style "fg=brightred,bg=default,bold"

# activity window title colors
set-window-option -g window-status-activity-style "fg=green,noreverse" 
set-window-option -g window-status-bell-style "fg=green,noreverse"
set-window-option -g window-status-style "fg=green,noreverse" 

# pane border
set-option -g pane-border-style "fg=yellow,bg=default"
set-option -g pane-active-border-style "fg=brightred,bg=default"

# message text
set-option -g message-style "bg=black,fg=brightred"

# pane number display
set-option -g display-panes-active-colour brightred #blue
set-option -g display-panes-colour brightblue #orange

# clock
set-window-option -g clock-mode-colour green #green

### USER SETTINGS

# bell settings
set-option -g bell-action any
set-option -g visual-bell off
set-option -g bell-on-alert on

# status bar settings
set-window-option -g automatic-rename off
set-window-option -g allow-rename off
set-option -g status-position top
set-option -g window-status-format '#I:#W#F'
set-option -g window-status-current-format '#I:#W#F'
set-option -g set-titles on
set-option -g set-titles-string '#S.#I.#P #W #T'
set-option -g status-left '#[fg=white]#[bg=black] #S.#I.#P #[default]'
set-option -g status-right "#[fg=cyan]#T#[fg=default] ❄ #[fg=white]%F %R"
set-option -g status-right-length 120

# misc settings
set-option -g history-limit 8192
set-option -g base-index 1
set-option -g renumber-windows on

# No delay for escape key press
set -sg escape-time 0

# mouse support
set-option -g mouse on
set-option -g mouse-utf8 on

# enable activity alerts
set-window-option -g monitor-activity on
set-option -g visual-activity off

# vim mode
set-window-option -g mode-keys vi
set-option -g status-keys vi

### KEY BINDINGS

# unbind unnecessary keys
unbind-key C-b
unbind-key [
unbind-key ]
unbind-key M-Right 
unbind-key M-Up
unbind-key M-Down
unbind-key M-Left
unbind-key M-p 
unbind-key M-n
unbind-key Left 
unbind-key Right
unbind-key Up
unbind-key Down
unbind-key z
unbind-key o
unbind-key c
unbind-key n
unbind-key f
unbind-key \;
unbind-key ( 
unbind-key )
unbind-key "'"
unbind-key &
unbind-key '"'
unbind-key "#"
unbind-key C-o
unbind-key C-?
unbind-key M-o

# Vim style split
bind-key v split-window -h
bind-key s split-window -v
bind-key j command-prompt -p "Join pane:" "join-pane -s '%%'"

# Vim style pane resizing
bind-key -r J resize-pane -D 5
bind-key -r K resize-pane -U 5
bind-key -r H resize-pane -L 5
bind-key -r L resize-pane -R 5

# Use Alt-vim keys without prefix key to switch panes
bind-key -n M-h select-pane -L
bind-key -n M-j select-pane -D 
bind-key -n M-k select-pane -U
bind-key -n M-l select-pane -R

# Shift arrow to switch windows
bind-key -n S-Left previous-window
bind-key -n S-Right next-window
bind-key -n S-M-Left swap-window -t -1
bind-key -n S-M-Right swap-window -t +1
bind-key -n S-Down new-window -c "$HOME"
bind-key -n S-Up command-prompt -I '#W' "rename-window '%%'"

# Alt -/= to switch windows
bind-key -n M-- previous-window
bind-key -n M-= next-window
bind-key -n M-_ swap-window -t -1
bind-key -n M-+ swap-window -t +1

# create/delete window
bind-key = new-window -c "$HOME"
bind-key - confirm-before -p "kill-window #W? (y/n)" kill-window 

# Reload tmux config
bind-key r source-file ~/.tmux.conf

# vim style copy/paste
bind-key Escape copy-mode
bind-key -t vi-copy 'v' begin-selection
bind-key -t vi-copy 'y' copy-selection
bind-key p paste-buffer
bind-key \ choose-buffer
bind-key BSpace delete-buffer

# tmux prefix key
set-option -g prefix M-`
bind-key M-` send-prefix

# confirm before detach client
bind-key d confirm-before -p "Detach client? (y/n)" detach-client

# select URL with tmux-url-select.pl
bind-key ` run-shell '/home/fedotov_sv/bin/tmux-url-select.pl'

# open URL in tmux buffer in chrome
bind-key o run-shell 'tmux save-buffer - | tr -d "\012" | tr -d " " | xargs -I@ xdg-open "@" >/dev/null'

# search tmux buffer in chrome
bind-key g run-shell 'tmux save-buffer - | tr -d "\012" | xargs -I@ xdg-open "http://google.ru/search?q=@" >/dev/null'

# copy tmux buffer to clipboard
bind-key y run-shell "tmux save-buffer - | xclip -selection clipboard >/dev/null"

# send tmux buffer to pastebin
#bind-key P run-shell "tmux save-buffer - | wgetpaste | awk '/:/ {print \$NF}' | xargs -I@ xdg-open \"@\" >/dev/null"
bind-key P run-shell "tmux save-buffer - | sheetpaste.sh | xargs -I@ xdg-open \"@\" >/dev/null"

# easily toggle synchronization (mnemonic: e is for echo)
bind-key e setw synchronize-panes on
bind-key E setw synchronize-panes off

# multi-ssh
bind-key M-s command-prompt -p "Enter target net for multi-ssh:" "run-shell 'echo %% | /home/fedotov_sv/bin/tmux-ssh.sh'"


# List of plugins
# set -g @plugin 'github_username/plugin_name'
# set -g @plugin 'git@github.com/user/plugin'
# set -g @plugin 'git@bitbucket.com/user/plugin'
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'jbnicolai/tmux-fpp'

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
